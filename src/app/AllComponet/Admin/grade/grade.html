<div class="container-custom">

  <!-- Add Grade -->
  <div class="card p-3 mt-4 border">
    <h5>Add New Grade</h5>

    <!-- Select Subject -->
    <div class="mb-2">
      <label>Select Subject</label>
      <select class="form-control"
              [(ngModel)]="selectedSubject"
              (ngModelChange)="onSubjectChange()">
        <option value="0" disabled>Select Subject</option>
        <option *ngFor="let sub of subjects" [value]="sub.id">
          {{ sub.subjectName }}
        </option>
      </select>
    </div>

    <!-- Grade Name -->
    <div class="mb-2">
      <label>Grade Name</label>
      <input class="form-control"
             type="text"
             placeholder="Enter Grade Name"
             [(ngModel)]="newGrade.gradeName">
    </div>

    <button class="btn btn-Action" (click)="addGrade()">Add Grade</button>
  </div>

  <!-- Grades Table -->
  <div class="card p-3 mt-4 border">

    <h5>Grades For Selected Subject</h5>

    <table class="table table-bordered table-hover mt-2" *ngIf="grades.length > 0">
      <thead>
        <tr>
          <th>Grade</th>
          <th>Actions</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let g of grades">

          <!-- Edit Mode -->
          <ng-container *ngIf="editingGradeId === g.id; else viewMode">
            <td>
              <input class="form-control" [(ngModel)]="editedGradeName">
            </td>

            <td>
              <button class="btn btn-success btn-sm me-1" (click)="updateGrade()">
                <i class="bi bi-check-lg"></i>
              </button>
              <button class="btn btn-secondary btn-sm" (click)="cancelEdit()">
                <i class="bi bi-x-lg"></i>
              </button>
            </td>
          </ng-container>

          <!-- View Mode -->
          <ng-template #viewMode>
            <td>{{ g.gradeName }}</td>
            <td>
              <button class="btn btn-primary btn-sm me-1" (click)="startEdit(g)">
                <i class="bi bi-pencil-square"></i>
              </button>
              <button class="btn btn-danger btn-sm" (click)="deleteGrade(g.id)">
                <i class="bi bi-trash-fill"></i>
              </button>
            </td>
          </ng-template>

        </tr>
      </tbody>
    </table>

    <div *ngIf="grades.length === 0 && selectedSubject > 0" class="alert alert-info mt-2">
      No grades found for this subject.
    </div>

  </div>

</div>
